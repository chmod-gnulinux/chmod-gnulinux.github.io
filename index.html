<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>CHMOD ONLINE EMULATOR</title>
  <meta name="description" content="Calculadora de permisos CHMOD en GNU/Linux" />
  <style>
    @font-face {
      font-family: 'FreeMono';
      src: url('./FreeMono.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }

    body {
      font-family: 'FreeMono', monospace;
      background: #f8f8f8;
      color: #111;
      margin: 0;
      padding: 1em;
      line-height: 1.5;
    }

    h1 {
      text-align: center;
      color: #222;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      max-width: 850px;
      margin: auto;
    }

    td {
      padding: 6px;
      text-align: center;
    }

    input[type="text"] {
      font-family: 'FreeMono', monospace;
      padding: 4px;
      text-align: center;
    }

    input[type="checkbox"] {
      transform: scale(1.2);
    }

    button {
      font-family: 'FreeMono', monospace;
      padding: 0.6em 1.2em;
      background: #444;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 0.3em;
      transition: background 0.2s;
    }

    button:hover {
      background: #000;
    }

    footer {
      text-align: center;
      margin-top: 2em;
      font-size: 0.9em;
    }

    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
      }
      table {
        width: 100%;
      }
    }
  </style>

  <script>
    function octalchange() {
      var val = document.chmod.t_total.value;
      var ownerbin = parseInt(val.charAt(0)).toString(2).padStart(3, '0');
      var groupbin = parseInt(val.charAt(1)).toString(2).padStart(3, '0');
      var otherbin = parseInt(val.charAt(2)).toString(2).padStart(3, '0');

      document.chmod.owner4.checked = parseInt(ownerbin[0]);
      document.chmod.owner2.checked = parseInt(ownerbin[1]);
      document.chmod.owner1.checked = parseInt(ownerbin[2]);
      document.chmod.group4.checked = parseInt(groupbin[0]);
      document.chmod.group2.checked = parseInt(groupbin[1]);
      document.chmod.group1.checked = parseInt(groupbin[2]);
      document.chmod.other4.checked = parseInt(otherbin[0]);
      document.chmod.other2.checked = parseInt(otherbin[1]);
      document.chmod.other1.checked = parseInt(otherbin[2]);
      calc_chmod(1);
    }

    function calc_chmod(nototals) {
      const users = ["owner", "group", "other"];
      const totals = [];
      const syms = [];

      users.forEach(user => {
        let total = 0;
        let sym = "";
        [4, 2, 1].forEach(v => {
          const chk = document.chmod[user + v].checked;
          total += chk ? v : 0;
          sym += chk ? (v == 4 ? "r" : v == 2 ? "w" : "x") : "-";
        });
        totals.push(total);
        syms.push(sym);
      });

      if (!nototals) document.chmod.t_total.value = totals.join("");
      document.chmod.sym_total.value = "-" + syms.join("");
    }

    function mostrarLicencia(tipo) {
      let texto = '';
      switch (tipo) {
        case 'gpl':
          texto = 'Código bajo GNU General Public License v3 o posterior (GPLv3+).';
          break;
        case 'fdl':
          texto = 'Documentación bajo GNU Free Documentation License (GFDL).';
          break;
        case 'fal':
          texto = 'Diseño visual bajo Free Art License 1.3.';
          break;
      }
      alert(texto);
    }

    window.onload = octalchange;
  </script>
</head>

<body>
  <h1>CALCULADORA DE PERMISOS CHMOD</h1>
  <p style="text-align:center;">Simulador para practicar el uso de <strong>chmod</strong> en GNU/Linux.</p>

  <form name="chmod">
    <table border="1">
      <tr style="background:#333;color:#fff;">
        <td>Permisos</td>
        <td>Propietario (u)</td>
        <td>Grupo (g)</td>
        <td>Otros (o)</td>
      </tr>
      <tr style="background:#eee;">
        <td>Lectura (r)</td>
        <td><input type="checkbox" name="owner4" value="4" onclick="calc_chmod()"></td>
        <td><input type="checkbox" name="group4" value="4" onclick="calc_chmod()"></td>
        <td><input type="checkbox" name="other4" value="4" onclick="calc_chmod()"></td>
      </tr>
      <tr style="background:#fff;">
        <td>Escritura (w)</td>
        <td><input type="checkbox" name="owner2" value="2" onclick="calc_chmod()"></td>
        <td><input type="checkbox" name="group2" value="2" onclick="calc_chmod()"></td>
        <td><input type="checkbox" name="other2" value="2" onclick="calc_chmod()"></td>
      </tr>
      <tr style="background:#eee;">
        <td>Ejecución (x)</td>
        <td><input type="checkbox" name="owner1" value="1" onclick="calc_chmod()"></td>
        <td><input type="checkbox" name="group1" value="1" onclick="calc_chmod()"></td>
        <td><input type="checkbox" name="other1" value="1" onclick="calc_chmod()"></td>
      </tr>
    </table>

    <div style="text-align:center;margin-top:1em;">
      <label>Permiso numérico:</label>
      <input name="t_total" maxlength="3" value="751" onkeyup="octalchange()">
      <label>Modo simbólico:</label>
      <input name="sym_total" readonly size="12" value="">
    </div>
  </form>

  <section style="margin-top:2em;">
    <h3>Explicación</h3>
    <p><strong>chmod</strong> (change mode) permite cambiar los permisos de archivos y directorios. Cada permiso tiene un valor:</p>
    <ul>
      <li>r (lectura) = 4</li>
      <li>w (escritura) = 2</li>
      <li>x (ejecución) = 1</li>
    </ul>
    <p>Por ejemplo, <code>chmod 755 archivo</code> otorga todos los permisos al propietario (7 = 4+2+1) y lectura/ejecución al grupo y otros (5 = 4+1).</p>
    <p>También puede usarse el modo simbólico: <code>chmod g+w archivo</code> añade permiso de escritura al grupo.</p>
  </section>

  <div style="text-align:center;margin-top:1em;">
    <button onclick="mostrarLicencia('gpl')">Licencia GNU GPL v3+</button>
    <button onclick="mostrarLicencia('fdl')">Licencia GNU FDL</button>
    <button onclick="mostrarLicencia('fal')">Free Art License 1.3</button>
  </div>

  <footer>
    <p><a href="https://gitlab.com/chmod-gnulinux" target="_blank">Repositorio en GitLab</a></p>
  </footer>

  <!-- ============================================================
  Licencias visibles también en el código fuente:
  - GNU GPL v3 o posterior: https://www.gnu.org/licenses/gpl-3.0.html
  - GNU FDL: https://www.gnu.org/licenses/fdl-1.3.html
  - Free Art License 1.3: https://artlibre.org/licence/lal/en/
  ============================================================ -->

</body>
</html>
