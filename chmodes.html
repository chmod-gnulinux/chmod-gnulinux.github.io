<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>CHMOD ONLINE EMULATOR</title>
  <style>
    @font-face {
      font-family: 'FreeMono';
      src: url('./FreeMono.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }

    body {
      font-family: 'FreeMono', monospace;
      background: #f8f8f8;
      color: #111;
      margin: 0;
      padding: 1em;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      max-width: 850px;
      margin: auto;
    }

    td {
      padding: 5px;
      text-align: center;
    }

    input[type="text"] {
      font-family: 'FreeMono', monospace;
      text-align: center;
      padding: 4px;
    }

    button {
      font-family: 'FreeMono', monospace;
      background: #444;
      color: #fff;
      border: none;
      padding: 0.6em 1em;
      border-radius: 5px;
      margin: 0.3em;
      cursor: pointer;
    }

    button:hover { background: #000; }

    @media (max-width: 600px) {
      body { font-size: 0.9em; }
      table { width: 100%; }
    }
  </style>
  <script>
    function octalchange() {
      var val = document.chmod.t_total.value;
      var ownerbin = parseInt(val.charAt(0)).toString(2).padStart(3, '0');
      var groupbin = parseInt(val.charAt(1)).toString(2).padStart(3, '0');
      var otherbin = parseInt(val.charAt(2)).toString(2).padStart(3, '0');
      document.chmod.owner4.checked = parseInt(ownerbin[0]);
      document.chmod.owner2.checked = parseInt(ownerbin[1]);
      document.chmod.owner1.checked = parseInt(ownerbin[2]);
      document.chmod.group4.checked = parseInt(groupbin[0]);
      document.chmod.group2.checked = parseInt(groupbin[1]);
      document.chmod.group1.checked = parseInt(groupbin[2]);
      document.chmod.other4.checked = parseInt(otherbin[0]);
      document.chmod.other2.checked = parseInt(otherbin[1]);
      document.chmod.other1.checked = parseInt(otherbin[2]);
      calc_chmod(1);
    }

    function calc_chmod(nototals) {
      const users = ["owner", "group", "other"];
      const totals = [];
      const syms = [];
      users.forEach(u => {
        let total = 0, sym = '';
        [4,2,1].forEach(v => {
          const c = document.chmod[u+v].checked;
          total += c ? v : 0;
          sym += c ? (v==4?'r':v==2?'w':'x') : '-';
        });
        totals.push(total);
        syms.push(sym);
      });
      if (!nototals) document.chmod.t_total.value = totals.join('');
      document.chmod.sym_total.value = '-' + syms.join('');
    }

    function mostrarLicencia(t) {
      let m = {
        gpl: 'Código bajo GNU General Public License v3 o posterior (GPLv3+).',
        fdl: 'Documentación bajo GNU Free Documentation License (GFDL).',
        fal: 'Diseño bajo Free Art License 1.3.'
      };
      alert(m[t]);
    }
    window.onload = octalchange;
  </script>
</head>
<body>
  <h1 style="text-align:center;">CALCULADORA PERMISOS CHMOD</h1>
  <p style="text-align:center;">Simulador para practicar chmod y entender los permisos en GNU/Linux.</p>
  <form name="chmod">
    <table border="1">
      <tr style="background:#333;color:#fff;">
        <td>Permisos</td><td>Propietario (u)</td><td>Grupo (g)</td><td>Otros (o)</td>
      </tr>
      <tr><td>Lectura (r)</td><td><input name="owner4" type="checkbox" value="4" onclick="calc_chmod()"></td><td><input name="group4" type="checkbox" value="4" onclick="calc_chmod()"></td><td><input name="other4" type="checkbox" value="4" onclick="calc_chmod()"></td></tr>
      <tr><td>Escritura (w)</td><td><input name="owner2" type="checkbox" value="2" onclick="calc_chmod()"></td><td><input name="group2" type="checkbox" value="2" onclick="calc_chmod()"></td><td><input name="other2" type="checkbox" value="2" onclick="calc_chmod()"></td></tr>
      <tr><td>Ejecución (x)</td><td><input name="owner1" type="checkbox" value="1" onclick="calc_chmod()"></td><td><input name="group1" type="checkbox" value="1" onclick="calc_chmod()"></td><td><input name="other1" type="checkbox" value="1" onclick="calc_chmod()"></td></tr>
    </table>
    <div style="text-align:center;margin-top:1em;">
      <label>Numérico:</label> <input name="t_total" maxlength="3" value="751" onkeyup="octalchange()">
      <label>Simbólico:</label> <input name="sym_total" readonly size="12">
    </div>
  </form>
  <div style="text-align:center;margin-top:1em;">
    <button onclick="mostrarLicencia('gpl')">GNU GPL v3+</button>
    <button onclick="mostrarLicencia('fdl')">GNU FDL</button>
    <button onclick="mostrarLicencia('fal')">Free Art License 1.3</button>
  </div>
  <!-- Licencias en código -->
  <!-- GNU GPL v3+: https://www.gnu.org/licenses/gpl-3.0.html -->
  <!-- GNU FDL: https://www.gnu.org/licenses/fdl-1.3.html -->
  <!-- Free Art License: https://artlibre.org/licence/lal/en/ -->
</body>
</html>
